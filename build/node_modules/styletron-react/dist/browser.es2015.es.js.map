{"version":3,"file":"browser.es2015.es.js","sources":["../src/dev-tool.js","../src/index.js"],"sourcesContent":["/* eslint-env browser */\n/* global module */\n\nexport function addDebugMetadata(instance, stackIndex) {\n  const {stack, stacktrace, message} = new Error(\"stacktrace source\");\n  instance.debug = {\n    stackInfo: {stack, stacktrace, message},\n    stackIndex: stackIndex,\n  };\n}\n\n// DEVTOOLS SETUP\ntype StyletronStyles = {\n  classes?: any,\n  styles?: any,\n  extends?: any,\n};\nexport const setupDevtoolsExtension = () => {\n  const atomicMap = {};\n  const extensionsMap = new Map();\n  const stylesMap = new Map();\n  const getStyles: StyletronStyles = className => {\n    const styles: StyletronStyles = {};\n    if (typeof className !== \"string\") {\n      return styles;\n    }\n    if (stylesMap.has(className)) {\n      styles.styles = stylesMap.get(className);\n      const classList = className.split(\" \");\n      if (classList.length) {\n        const classes = {};\n        classList.forEach(singleClassName => {\n          classes[singleClassName] = atomicMap[singleClassName];\n        });\n        styles.classes = classes;\n      }\n      if (extensionsMap.has(className)) {\n        const extension = extensionsMap.get(className);\n        styles.extends = extension;\n      }\n      return styles;\n    }\n  };\n  window.__STYLETRON_DEVTOOLS__ = {\n    atomicMap,\n    extensionsMap,\n    stylesMap,\n    getStyles,\n  };\n};\n\nclass BrowserDebugEngine {\n  constructor(worker) {\n    if (!worker) {\n      const workerBlob = new Blob(\n        [\n          `importScripts(\"https://unpkg.com/css-to-js-sourcemap-worker@2.0.5/worker.js\")`,\n        ],\n        {type: \"application/javascript\"},\n      );\n      worker = new Worker(URL.createObjectURL(workerBlob));\n      worker.postMessage({\n        id: \"init_wasm\",\n        url: \"https://unpkg.com/css-to-js-sourcemap-worker@2.0.5/mappings.wasm\",\n      });\n      worker.postMessage({\n        id: \"set_render_interval\",\n        interval: 120,\n      });\n      if (module.hot) {\n        module.hot.addStatusHandler(status => {\n          if (status === \"dispose\") {\n            worker.postMessage({id: \"invalidate\"});\n          }\n        });\n      }\n    }\n    this.worker = worker;\n    this.counter = 0;\n    this.worker.onmessage = msg => {\n      const {id, css} = msg.data;\n      if (id === \"render_css\" && css) {\n        const style = document.createElement(\"style\");\n        style.appendChild(document.createTextNode(css));\n        document.head.appendChild(style);\n      }\n    };\n  }\n\n  debug({stackIndex, stackInfo}) {\n    const className = `__debug-${this.counter++}`;\n    this.worker.postMessage({\n      id: \"add_mapped_class\",\n      className,\n      stackInfo,\n      stackIndex,\n    });\n    return className;\n  }\n}\n\nclass NoopDebugEngine {\n  debug() {}\n}\n\nexport const DebugEngine = __BROWSER__ ? BrowserDebugEngine : NoopDebugEngine;\n","// @flow\n/* eslint-env browser */\n/* eslint-disable no-unused-vars, no-redeclare, no-shadow */\n\ndeclare var __DEV__: boolean;\ndeclare var __BROWSER__: boolean;\ndeclare var process: any;\n\nimport * as React from \"react\";\nimport {\n  driver,\n  getInitialStyle,\n  type StandardEngine,\n  type StyleObject,\n} from \"styletron-standard\";\n\nimport type {\n  Styletron,\n  StyletronComponent,\n  ReducerContainer,\n  AssignmentCommutativeReducerContainer,\n  NonAssignmentCommutativeReducerContainer,\n  StyledFn,\n  WithStyleFn,\n  WithTransformFn,\n  WithWrapperFn,\n} from \"./types.js\";\nimport {\n  addDebugMetadata,\n  setupDevtoolsExtension,\n  DebugEngine,\n} from \"./dev-tool.js\";\n\nexport {DebugEngine};\nexport type {StyleObject};\n\nconst noopEngine = {\n  renderStyle: () => \"\",\n  renderKeyframes: () => \"\",\n  renderFontFace: () => \"\",\n};\n\nconst StyletronContext = React.createContext<StandardEngine>(noopEngine);\nconst HydrationContext = React.createContext(false);\nconst DebugEngineContext = React.createContext();\nconst ThemeContext = React.createContext();\n\ntype DevProviderProps = {\n  children: React.Node,\n  value: StandardEngine,\n  debugAfterHydration?: boolean,\n  debug?: any,\n};\n\nclass DevProvider extends React.Component<\n  DevProviderProps,\n  {hydrating: boolean},\n> {\n  constructor(props: DevProviderProps) {\n    super();\n    this.state = {\n      hydrating: Boolean(props.debugAfterHydration),\n    };\n  }\n\n  componentDidMount() {\n    if (__BROWSER__) {\n      if (this.state.hydrating === true) {\n        this.setState({\n          hydrating: false,\n        });\n      }\n    }\n  }\n\n  render() {\n    return (\n      <StyletronContext.Provider value={this.props.value}>\n        <DebugEngineContext.Provider value={this.props.debug}>\n          <HydrationContext.Provider value={this.state.hydrating}>\n            {this.props.children}\n          </HydrationContext.Provider>\n        </DebugEngineContext.Provider>\n      </StyletronContext.Provider>\n    );\n  }\n}\n\nexport const Provider =\n  __BROWSER__ && __DEV__ ? DevProvider : StyletronContext.Provider;\n\nif (__BROWSER__ && __DEV__ && !window.__STYLETRON_DEVTOOLS__) {\n  setupDevtoolsExtension();\n}\n\n// TODO: more precise types\nexport function DevConsumer(props: {children: (any, any, any) => React.Node}) {\n  return (\n    <StyletronContext.Consumer>\n      {styletronEngine => (\n        <DebugEngineContext.Consumer>\n          {debugEngine => (\n            <HydrationContext.Consumer>\n              {hydrating =>\n                props.children(styletronEngine, debugEngine, hydrating)\n              }\n            </HydrationContext.Consumer>\n          )}\n        </DebugEngineContext.Consumer>\n      )}\n    </StyletronContext.Consumer>\n  );\n}\n\nconst Consumer =\n  __BROWSER__ && __DEV__ ? DevConsumer : StyletronContext.Consumer;\n\ntype createStyledOpts = {\n  getInitialStyle: () => StyleObject,\n  driver: typeof driver,\n  wrapper: (\n    React.StatelessFunctionalComponent<any>,\n  ) => React.ComponentType<any>,\n};\n\nfunction checkNoopEngine(engine: StandardEngine) {\n  // if no engine provided, we default to no-op, handy for tests\n  // however, print a warning in other envs\n  if (process.env.NODE_ENV !== \"test\") {\n    engine === noopEngine &&\n      // eslint-disable-next-line no-console\n      console.warn(\n        __DEV__\n          ? `\nStyletron has been switched to a no-op (test) mode.\n\nA Styletron styled component was rendered, but no Styletron engine instance was provided in React context.\n\nDid you forget to provide a Styletron engine instance to React context via using the Styletron provider component?\n\nNote: Providers and Consumers must come from the exact same React.createContext call to work.\nIf your app has multiple instances of the \"styletron-react\" package in your node_module tree,\nyour Provider may be coming from a different React.createContext call, which means the styled components\nwill not recieve the provided engine instance. This scenario can arise, for example, when using \"npm link\".\n`\n          : `Styletron Provider is not set up. Defaulting to no-op.`,\n      );\n  }\n}\n\nexport function useStyletron() {\n  const styletronEngine: StandardEngine = React.useContext(StyletronContext);\n  const debugEngine = React.useContext(DebugEngineContext);\n  const hydrating = React.useContext(HydrationContext);\n  checkNoopEngine(styletronEngine);\n\n  const debugClassName = React.useRef(\"\");\n  const prevDebugClassNameDeps = React.useRef([]);\n\n  return [\n    function css(style: StyleObject) {\n      const className = driver(style, styletronEngine);\n      if (!(__BROWSER__ && __DEV__)) {\n        return className;\n      }\n      const {stack, message} = new Error(\"stacktrace source\");\n\n      const nextDeps = [debugEngine, hydrating];\n      if (\n        prevDebugClassNameDeps.current[0] !== nextDeps[0] ||\n        prevDebugClassNameDeps.current[1] !== nextDeps[1]\n      ) {\n        if (debugEngine && !hydrating) {\n          debugClassName.current = debugEngine.debug({\n            stackInfo: {stack, message},\n            stackIndex: 1,\n          });\n        }\n        prevDebugClassNameDeps.current = nextDeps;\n      }\n\n      if (debugClassName.current) {\n        return `${debugClassName.current} ${className}`;\n      }\n\n      return className;\n    },\n  ];\n}\n\nexport function createStyled({\n  getInitialStyle,\n  driver,\n  wrapper,\n}: createStyledOpts): StyledFn {\n  function styled(base: any, styleArg) {\n    if (__DEV__) {\n      if (base.__STYLETRON__) {\n        /* eslint-disable no-console */\n        console.warn(\n          \"It appears you are passing a styled component into `styled`.\",\n        );\n        console.warn(\n          \"For composition with existing styled components, use `withStyle` or `withTransform` instead.\",\n        );\n        /* eslint-enable no-console */\n      }\n    }\n\n    const baseStyletron: Styletron = {\n      reducers: [],\n      base: base,\n      driver,\n      getInitialStyle,\n      wrapper,\n    };\n\n    if (__BROWSER__ && __DEV__) {\n      addDebugMetadata(baseStyletron, 2);\n    }\n\n    return createStyledElementComponent(\n      autoComposeShallow(baseStyletron, styleArg),\n    );\n  }\n\n  return styled;\n}\n\nexport const styled: StyledFn = createStyled({\n  getInitialStyle,\n  driver,\n  wrapper: Component => Component,\n});\n\ndeclare var withTransform: WithTransformFn;\nexport function withTransform(component, transformer) {\n  const styletron = component.__STYLETRON__;\n\n  if (__BROWSER__ && __DEV__) {\n    addDebugMetadata(styletron, 2);\n  }\n\n  return createStyledElementComponent(composeDynamic(styletron, transformer));\n}\n\ndeclare var withStyle: WithStyleFn;\nexport var withStyle = withStyleDeep;\n\ndeclare var withStyleDeep: WithStyleFn;\nexport function withStyleDeep(component, styleArg) {\n  const styletron = component.__STYLETRON__;\n\n  if (__DEV__) {\n    if (!styletron) {\n      /* eslint-disable no-console */\n      console.warn(\n        \"The first parameter to `withStyle` must be a styled component (without extra wrappers).\",\n      );\n      /* eslint-enable no-console */\n    }\n  }\n\n  if (__BROWSER__ && __DEV__) {\n    addDebugMetadata(styletron, 2);\n    return createStyledElementComponent(\n      addExtension(autoComposeDeep(styletron, styleArg), component, styleArg),\n    );\n  } else {\n    return createStyledElementComponent(autoComposeDeep(styletron, styleArg));\n  }\n}\n\ndeclare var withWrapper: WithWrapperFn;\nexport function withWrapper(component, wrapper) {\n  const styletron = component.__STYLETRON__;\n\n  if (__DEV__) {\n    if (!styletron) {\n      /* eslint-disable no-console */\n      console.warn(\n        \"The first parameter to `withWrapper` must be a styled component (without extra wrappers).\",\n      );\n      /* eslint-enable no-console */\n    }\n  }\n\n  const composed = {\n    getInitialStyle: styletron.getInitialStyle,\n    base: styletron.base,\n    driver: styletron.driver,\n    wrapper: wrapper,\n    reducers: styletron.reducers,\n  };\n\n  if (__BROWSER__ && __DEV__) {\n    addDebugMetadata(composed, 2);\n  }\n\n  return createStyledElementComponent(composed);\n}\n\nexport function autoComposeShallow<Props>(\n  styletron: Styletron,\n  styleArg: StyleObject | (Props => StyleObject),\n) {\n  if (typeof styleArg === \"function\") {\n    return dynamicComposeShallow(styletron, styleArg);\n  }\n\n  return staticComposeShallow(styletron, styleArg);\n}\n\nfunction addExtension(composed, component, styleArg) {\n  return {\n    ...composed,\n    ext: {\n      with: styleArg,\n      name: component.displayName,\n      base: component.__STYLETRON__.base,\n      getInitialStyle: component.__STYLETRON__.reducers.length\n        ? component.__STYLETRON__.reducers[0].reducer\n        : component.__STYLETRON__.getInitialStyle,\n    },\n  };\n}\n\nexport function autoComposeDeep<Props>(\n  styletron: Styletron,\n  styleArg: StyleObject | (Props => StyleObject),\n) {\n  if (typeof styleArg === \"function\") {\n    return dynamicComposeDeep(styletron, styleArg);\n  }\n\n  return staticComposeDeep(styletron, styleArg);\n}\n\nexport function staticComposeShallow(styletron: Styletron, style: StyleObject) {\n  return composeStatic(styletron, createShallowMergeReducer(style));\n}\n\nexport function staticComposeDeep(styletron: Styletron, style: StyleObject) {\n  return composeStatic(styletron, createDeepMergeReducer(style));\n}\n\nexport function dynamicComposeShallow<Props>(\n  styletron: Styletron,\n  styleFn: Props => StyleObject,\n) {\n  return composeDynamic(styletron, (style, props) =>\n    shallowMerge(style, styleFn(props)),\n  );\n}\n\nexport function dynamicComposeDeep<Props>(\n  styletron: Styletron,\n  styleFn: Props => StyleObject,\n) {\n  return composeDynamic(styletron, (style, props) =>\n    deepMerge(style, styleFn(props)),\n  );\n}\n\nexport function createShallowMergeReducer(\n  style: StyleObject,\n): AssignmentCommutativeReducerContainer {\n  return {\n    reducer: inputStyle => shallowMerge(inputStyle, style),\n    assignmentCommutative: true,\n    factory: createShallowMergeReducer,\n    style: style,\n  };\n}\n\nexport function createDeepMergeReducer(\n  style: StyleObject,\n): AssignmentCommutativeReducerContainer {\n  return {\n    reducer: inputStyle => deepMerge(inputStyle, style),\n    assignmentCommutative: true,\n    factory: createDeepMergeReducer,\n    style: style,\n  };\n}\n\nexport function composeStatic(\n  styletron: Styletron,\n  reducerContainer: AssignmentCommutativeReducerContainer,\n) {\n  if (styletron.reducers.length === 0) {\n    const style = reducerContainer.reducer(styletron.getInitialStyle());\n    const result: Styletron = {\n      reducers: styletron.reducers,\n      base: styletron.base,\n      driver: styletron.driver,\n      wrapper: styletron.wrapper,\n      getInitialStyle: () => style,\n    };\n    if (__BROWSER__ && __DEV__) {\n      result.debug = styletron.debug;\n    }\n    return result;\n  } else {\n    const last = styletron.reducers[0];\n\n    if (\n      last.assignmentCommutative === true &&\n      reducerContainer.assignmentCommutative === true\n    ) {\n      const composed = reducerContainer.reducer(last.style);\n\n      const result: Styletron = {\n        getInitialStyle: styletron.getInitialStyle,\n        base: styletron.base,\n        driver: styletron.driver,\n        wrapper: styletron.wrapper,\n        reducers: [last.factory(composed)].concat(styletron.reducers.slice(1)),\n      };\n\n      if (__BROWSER__ && __DEV__) {\n        result.debug = styletron.debug;\n      }\n\n      return result;\n    }\n\n    return composeDynamic(styletron, reducerContainer.reducer);\n  }\n}\n\nexport function composeDynamic<Props>(\n  styletron: Styletron,\n  reducer: (StyleObject, Props) => StyleObject,\n) {\n  const composed: Styletron = {\n    getInitialStyle: styletron.getInitialStyle,\n    base: styletron.base,\n    driver: styletron.driver,\n    wrapper: styletron.wrapper,\n    reducers: [{assignmentCommutative: false, reducer}].concat(\n      styletron.reducers,\n    ),\n  };\n  if (__BROWSER__ && __DEV__) {\n    composed.debug = styletron.debug;\n  }\n  return composed;\n}\n\nexport function createStyledElementComponent(styletron: Styletron) {\n  const {reducers, base, driver, wrapper, getInitialStyle, ext} = styletron;\n\n  if (__BROWSER__ && __DEV__) {\n    var debugStackInfo, debugStackIndex;\n    if (styletron.debug) {\n      debugStackInfo = styletron.debug.stackInfo;\n      debugStackIndex = styletron.debug.stackIndex;\n    }\n  }\n\n  if (__BROWSER__ && __DEV__) {\n    var debugClassName;\n  }\n\n  const StyledElement = React.forwardRef((props, ref) => {\n    return (\n      <Consumer>\n        {(styletron, debugEngine, hydrating) => {\n          checkNoopEngine(styletron);\n\n          const elementProps = omitPrefixedKeys(props);\n          let style = resolveStyle(getInitialStyle, reducers, props);\n\n          if (props.$style) {\n            if (typeof props.$style === \"function\") {\n              style = deepMerge(style, props.$style(props));\n            } else {\n              style = deepMerge(style, props.$style);\n            }\n          }\n\n          const styleClassString = driver(style, styletron);\n          const Element = props.$as ? props.$as : base;\n          elementProps.className = props.className\n            ? `${props.className} ${styleClassString}`\n            : styleClassString;\n\n          if (__BROWSER__ && __DEV__ && debugEngine && !hydrating) {\n            if (!debugClassName) {\n              debugClassName = debugEngine.debug({\n                stackInfo: debugStackInfo,\n                stackIndex: debugStackIndex,\n              });\n            }\n\n            const joined = `${debugClassName} ${elementProps.className}`;\n            elementProps.className = joined;\n          }\n\n          if (__BROWSER__ && __DEV__ && window.__STYLETRON_DEVTOOLS__) {\n            window.__STYLETRON_DEVTOOLS__.stylesMap.set(\n              elementProps.className,\n              style,\n            );\n            if (ext) {\n              window.__STYLETRON_DEVTOOLS__.extensionsMap.set(\n                elementProps.className,\n                {\n                  base: ext.base,\n                  displayName: ext.name,\n                  initialStyles: ext.getInitialStyle({}, props),\n                  styleOverrides:\n                    typeof ext.with === \"function\" ? ext.with(props) : ext.with,\n                },\n              );\n            }\n          }\n\n          if (props.$ref) {\n            // eslint-disable-next-line no-console\n            console.warn(\n              \"The prop `$ref` has been deprecated. Use `ref` instead. Refs are now forwarded with React.forwardRef.\",\n            );\n          }\n          return <Element {...elementProps} ref={ref || props.$ref} />;\n        }}\n      </Consumer>\n    );\n  });\n\n  const Wrapped = wrapper(StyledElement);\n  Wrapped.__STYLETRON__ = {\n    base,\n    reducers,\n    driver,\n    wrapper,\n    getInitialStyle,\n  };\n\n  if (__DEV__) {\n    let displayName;\n\n    if (typeof base === \"string\") {\n      displayName = base;\n    } else if (base.displayName) {\n      displayName = base.displayName;\n    } else if (base.name) {\n      displayName = base.name;\n    } else {\n      displayName = \"Unknown\";\n    }\n\n    Wrapped.displayName = `Styled(${displayName})`;\n  }\n\n  return Wrapped;\n}\n\n// Utility functions\n\nexport function resolveStyle(\n  getInitialStyle: void => StyleObject,\n  reducers: Array<ReducerContainer>,\n  props: Object,\n): StyleObject {\n  let result = getInitialStyle();\n  let i = reducers.length;\n  while (i--) {\n    // Cast to allow passing unused props param in case of static reducer\n    const reducer = (reducers[i].reducer: (StyleObject, Object) => StyleObject);\n    result = reducer(result, props);\n  }\n  return result;\n}\n\nfunction isObject(x: any) {\n  return typeof x === \"object\" && x !== null;\n}\n\nfunction omitPrefixedKeys(source) {\n  const result = {};\n\n  for (const key in source) {\n    if (key[0] !== \"$\") {\n      result[key] = source[key];\n    }\n  }\n\n  return result;\n}\n\nfunction deepMerge(a, b) {\n  const result = assign({}, a);\n\n  for (const key in b) {\n    const val = b[key];\n\n    if (isObject(val) && isObject(a[key])) {\n      result[key] = deepMerge(a[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  return result;\n}\n\nfunction shallowMerge(a, b) {\n  return assign(assign({}, a), b);\n}\n\nfunction assign(target, source) {\n  for (const key in source) {\n    target[key] = source[key];\n  }\n  return target;\n}\n"],"names":["addDebugMetadata","instance","stackIndex","Error","debug","setupDevtoolsExtension","atomicMap","extensionsMap","Map","stylesMap","getStyles","className","styles","has","get","classList","split","length","classes","forEach","singleClassName","extension","extends","__STYLETRON_DEVTOOLS__","BrowserDebugEngine","worker","workerBlob","Blob","Worker","URL","createObjectURL","postMessage","module","hot","addStatusHandler","status","counter","onmessage","msg","data","id","css","style","document","createElement","appendChild","createTextNode","head","DebugEngine","noopEngine","StyletronContext","React","HydrationContext","DebugEngineContext","ThemeContext","DevProvider","props","state","Boolean","debugAfterHydration","hydrating","setState","React.createElement","value","children","Provider","window","DevConsumer","styletronEngine","debugEngine","Consumer","checkNoopEngine","engine","process","env","NODE_ENV","warn","useStyletron","debugClassName","prevDebugClassNameDeps","driver","nextDeps","current","createStyled","styled","base","styleArg","__STYLETRON__","baseStyletron","createStyledElementComponent","autoComposeShallow","Component","withTransform","component","transformer","styletron","composeDynamic","withStyle","withStyleDeep","addExtension","autoComposeDeep","withWrapper","wrapper","composed","getInitialStyle","reducers","dynamicComposeShallow","staticComposeShallow","displayName","reducer","dynamicComposeDeep","staticComposeDeep","composeStatic","createShallowMergeReducer","createDeepMergeReducer","styleFn","shallowMerge","deepMerge","inputStyle","reducerContainer","result","last","assignmentCommutative","factory","concat","slice","debugStackInfo","debugStackIndex","stackInfo","StyledElement","ref","elementProps","omitPrefixedKeys","resolveStyle","$style","styleClassString","Element","$as","joined","set","ext","name","with","$ref","Wrapped","i","isObject","x","source","key","a","b","assign","val","target"],"mappings":"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"}