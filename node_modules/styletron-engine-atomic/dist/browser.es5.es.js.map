{"version":3,"file":"browser.es5.es.js","sources":["../src/sequential-id-generator.js","../src/sort-css-media-queries.js","../src/cache.js","../src/hyphenate-style-name.js","../src/validate-no-mixed-hand.js","../src/inject-style-prefixed.js","../src/validate-keyframes-object.js","../src/css.js","../src/dev-tool.js","../src/client/client.js","../src/server/server.js"],"sourcesContent":["// @flow\n\nexport default class SequentialIDGenerator {\n  prefix: string;\n  count: number;\n  offset: number;\n  msb: number;\n  power: number;\n\n  constructor(prefix: string = \"\") {\n    // ensure start with \"ae\" so \"ad\" is never produced\n    this.prefix = prefix;\n    this.count = 0;\n    this.offset = 374;\n    this.msb = 1295;\n    this.power = 2;\n  }\n\n  next() {\n    const id = this.increment().toString(36);\n    return this.prefix ? `${this.prefix}${id}` : id;\n  }\n\n  increment() {\n    const id = this.count + this.offset;\n    if (id === this.msb) {\n      this.offset += (this.msb + 1) * 9;\n      this.msb = Math.pow(36, ++this.power) - 1;\n    }\n    this.count++;\n    return id;\n  }\n}\n","// adapted from https://github.com/dutchenkoOleg/sort-css-media-queries\n\n// @flow\n\nconst minMaxWidth = /(!?\\(\\s*min(-device-)?-width).+\\(\\s*max(-device)?-width/i;\nconst minWidth = /\\(\\s*min(-device)?-width/i;\nconst maxMinWidth = /(!?\\(\\s*max(-device)?-width).+\\(\\s*min(-device)?-width/i;\nconst maxWidth = /\\(\\s*max(-device)?-width/i;\n\nconst isMinWidth = _testQuery(minMaxWidth, maxMinWidth, minWidth);\nconst isMaxWidth = _testQuery(maxMinWidth, minMaxWidth, maxWidth);\n\nconst minMaxHeight = /(!?\\(\\s*min(-device)?-height).+\\(\\s*max(-device)?-height/i;\nconst minHeight = /\\(\\s*min(-device)?-height/i;\nconst maxMinHeight = /(!?\\(\\s*max(-device)?-height).+\\(\\s*min(-device)?-height/i;\nconst maxHeight = /\\(\\s*max(-device)?-height/i;\n\nconst isMinHeight = _testQuery(minMaxHeight, maxMinHeight, minHeight);\nconst isMaxHeight = _testQuery(maxMinHeight, minMaxHeight, maxHeight);\n\nconst isPrint = /print/i;\nconst isPrintOnly = /^print$/i;\nconst maxValue = Number.MAX_VALUE;\n\nfunction _getQueryLength(length: string) {\n  const matches = /(-?\\d*\\.?\\d+)(ch|em|ex|px|rem)/.exec(length);\n  if (matches === null) {\n    return maxValue;\n  }\n  let number = matches[1];\n  const unit = matches[2];\n  switch (unit) {\n    case \"ch\":\n      number = parseFloat(number) * 8.8984375;\n      break;\n    case \"em\":\n    case \"rem\":\n      number = parseFloat(number) * 16;\n      break;\n    case \"ex\":\n      number = parseFloat(number) * 8.296875;\n      break;\n    case \"px\":\n      number = parseFloat(number);\n      break;\n  }\n  return +number;\n}\n\nfunction _testQuery(\n  doubleTestTrue: RegExp,\n  doubleTestFalse: RegExp,\n  singleTest: RegExp,\n) {\n  return function(query: string) {\n    if (doubleTestTrue.test(query)) {\n      return true;\n    } else if (doubleTestFalse.test(query)) {\n      return false;\n    }\n    return singleTest.test(query);\n  };\n}\n\nfunction _testIsPrint(a: string, b: string) {\n  const isPrintA = isPrint.test(a);\n  const isPrintOnlyA = isPrintOnly.test(a);\n  const isPrintB = isPrint.test(b);\n  const isPrintOnlyB = isPrintOnly.test(b);\n\n  if (isPrintA && isPrintB) {\n    if (!isPrintOnlyA && isPrintOnlyB) {\n      return 1;\n    }\n    if (isPrintOnlyA && !isPrintOnlyB) {\n      return -1;\n    }\n    return a.localeCompare(b);\n  }\n  if (isPrintA) {\n    return 1;\n  }\n  if (isPrintB) {\n    return -1;\n  }\n  return null;\n}\n\nexport default function sortCSSmq(a: string, b: string) {\n  if (a === \"\") {\n    return -1;\n  }\n  if (b === \"\") {\n    return 1;\n  }\n  const testIsPrint = _testIsPrint(a, b);\n  if (testIsPrint !== null) {\n    return testIsPrint;\n  }\n\n  const minA = isMinWidth(a) || isMinHeight(a);\n  const maxA = isMaxWidth(a) || isMaxHeight(a);\n  const minB = isMinWidth(b) || isMinHeight(b);\n  const maxB = isMaxWidth(b) || isMaxHeight(b);\n\n  if (minA && maxB) {\n    return -1;\n  }\n  if (maxA && minB) {\n    return 1;\n  }\n\n  const lengthA = _getQueryLength(a);\n  const lengthB = _getQueryLength(b);\n\n  if (lengthA === maxValue && lengthB === maxValue) {\n    return a.localeCompare(b);\n  } else if (lengthA === maxValue) {\n    return 1;\n  } else if (lengthB === maxValue) {\n    return -1;\n  }\n\n  if (lengthA > lengthB) {\n    if (maxA) {\n      return -1;\n    }\n    return 1;\n  }\n\n  if (lengthA < lengthB) {\n    if (maxA) {\n      return 1;\n    }\n    return -1;\n  }\n\n  return a.localeCompare(b);\n}\n","// @flow\n\nimport SequentialIDGenerator from \"./sequential-id-generator.js\";\nimport sortMq from \"./sort-css-media-queries.js\";\n\nexport class MultiCache<T> {\n  caches: {[string]: Cache<T>};\n  idGenerator: SequentialIDGenerator;\n  onNewCache: (string, Cache<T>, ?string) => any;\n  onNewValue: (cache: Cache<T>, id: string, value: T) => any;\n  sortedCacheKeys: string[];\n\n  constructor(\n    idGenerator: SequentialIDGenerator,\n    onNewCache: Function,\n    onNewValue: Function,\n  ) {\n    this.idGenerator = idGenerator;\n    this.onNewCache = onNewCache;\n    this.onNewValue = onNewValue;\n    this.sortedCacheKeys = [];\n    this.caches = {};\n  }\n\n  getCache(key: string): Cache<T> {\n    if (!this.caches[key]) {\n      const cache = new Cache(this.idGenerator, this.onNewValue);\n      cache.key = key;\n      this.sortedCacheKeys.push(key);\n      this.sortedCacheKeys.sort(sortMq);\n      const keyIndex = this.sortedCacheKeys.indexOf(key);\n      const insertBeforeMedia =\n        keyIndex < this.sortedCacheKeys.length - 1\n          ? this.sortedCacheKeys[keyIndex + 1]\n          : void 0;\n      this.caches[key] = cache;\n      this.onNewCache(key, cache, insertBeforeMedia);\n    }\n    return this.caches[key];\n  }\n\n  getSortedCacheKeys() {\n    return this.sortedCacheKeys;\n  }\n}\n\nexport class Cache<T> {\n  cache: {[string]: string};\n  idGenerator: SequentialIDGenerator;\n  key: string;\n  onNewValue: (cache: Cache<T>, id: string, value: any) => any;\n\n  constructor(\n    idGenerator: SequentialIDGenerator,\n    onNewValue: (cache: Cache<T>, id: string, value: any) => any,\n  ) {\n    this.cache = {};\n    this.idGenerator = idGenerator;\n    this.onNewValue = onNewValue;\n  }\n\n  addValue(key: string, value: T) {\n    const cached = this.cache[key];\n    if (cached) {\n      return cached;\n    }\n    const id = this.idGenerator.next();\n    this.cache[key] = id;\n    this.onNewValue(this, id, value);\n    return id;\n  }\n}\n","// @flow\n\nconst uppercasePattern = /[A-Z]/g;\nconst msPattern = /^ms-/;\nconst cache = {};\n\nexport default function hyphenateStyleName(prop: string): string {\n  return prop in cache\n    ? cache[prop]\n    : (cache[prop] = prop\n        .replace(uppercasePattern, \"-$&\")\n        .toLowerCase()\n        .replace(msPattern, \"-ms-\"));\n}\n","// @flow\n\n/**\n * Adapted from https://github.com/gilmoreorless/css-shorthand-properties\n */\n\nimport hyphenate from \"./hyphenate-style-name.js\";\n\nconst shorthandMap = {\n  // CSS 2.1: https://www.w3.org/TR/CSS2/propidx.html\n  \"list-style\": [\"list-style-type\", \"list-style-position\", \"list-style-image\"],\n  margin: [\"margin-top\", \"margin-right\", \"margin-bottom\", \"margin-left\"],\n  outline: [\"outline-width\", \"outline-style\", \"outline-color\"],\n  padding: [\"padding-top\", \"padding-right\", \"padding-bottom\", \"padding-left\"],\n\n  // CSS Backgrounds and Borders Module Level 3: https://www.w3.org/TR/css3-background/\n  background: [\n    \"background-image\",\n    \"background-position\",\n    \"background-size\",\n    \"background-repeat\",\n    \"background-origin\",\n    \"background-clip\",\n    \"background-attachment\",\n    \"background-color\",\n  ],\n  border: [\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n    \"border-width\",\n    \"border-top-style\",\n    \"border-right-style\",\n    \"border-bottom-style\",\n    \"border-left-style\",\n    \"border-style\",\n    \"border-top-color\",\n    \"border-right-color\",\n    \"border-bottom-color\",\n    \"border-left-color\",\n    \"border-color\",\n  ],\n  \"border-color\": [\n    \"border-top-color\",\n    \"border-right-color\",\n    \"border-bottom-color\",\n    \"border-left-color\",\n  ],\n  \"border-style\": [\n    \"border-top-style\",\n    \"border-right-style\",\n    \"border-bottom-style\",\n    \"border-left-style\",\n  ],\n  \"border-width\": [\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n  ],\n  \"border-top\": [\"border-top-width\", \"border-top-style\", \"border-top-color\"],\n  \"border-right\": [\n    \"border-right-width\",\n    \"border-right-style\",\n    \"border-right-color\",\n  ],\n  \"border-bottom\": [\n    \"border-bottom-width\",\n    \"border-bottom-style\",\n    \"border-bottom-color\",\n  ],\n  \"border-left\": [\n    \"border-left-width\",\n    \"border-left-style\",\n    \"border-left-color\",\n  ],\n  \"border-radius\": [\n    \"border-top-left-radius\",\n    \"border-top-right-radius\",\n    \"border-bottom-right-radius\",\n    \"border-bottom-left-radius\",\n  ],\n  \"border-image\": [\n    \"border-image-source\",\n    \"border-image-slice\",\n    \"border-image-width\",\n    \"border-image-outset\",\n    \"border-image-repeat\",\n  ],\n\n  // CSS Fonts Module Level 3: https://www.w3.org/TR/css3-fonts/\n  font: [\n    \"font-style\",\n    \"font-variant-ligatures\",\n    \"font-variant-alternates\",\n    \"font-variant-caps\",\n    \"font-variant-numeric\",\n    \"font-variant-east-asian\",\n    \"font-variant\",\n    \"font-weight\",\n    \"font-stretch\",\n    \"font-size\",\n    \"line-height\",\n    \"font-family\",\n  ],\n  \"font-variant\": [\n    \"font-variant-ligatures\",\n    \"font-variant-alternates\",\n    \"font-variant-caps\",\n    \"font-variant-numeric\",\n    \"font-variant-east-asian\",\n  ],\n\n  // CSS Flexible Box Layout Module Level 1: https://www.w3.org/TR/css3-flexbox-1/\n  flex: [\"flex-grow\", \"flex-shrink\", \"flex-basis\"],\n  \"flex-flow\": [\"flex-direction\", \"flex-wrap\"],\n\n  // CSS Grid Layout Module Level 1: https://www.w3.org/TR/css-grid-1/\n  grid: [\n    \"grid-template-rows\",\n    \"grid-template-columns\",\n    \"grid-template-areas\",\n    \"grid-auto-rows\",\n    \"grid-auto-columns\",\n    \"grid-auto-flow\",\n  ],\n  \"grid-template\": [\n    \"grid-template-rows\",\n    \"grid-template-columns\",\n    \"grid-template-areas\",\n  ],\n  \"grid-row\": [\"grid-row-start\", \"grid-row-end\"],\n  \"grid-column\": [\"grid-column-start\", \"grid-column-end\"],\n  \"grid-area\": [\n    \"grid-row-start\",\n    \"grid-column-start\",\n    \"grid-row-end\",\n    \"grid-column-end\",\n  ],\n  \"grid-gap\": [\"grid-row-gap\", \"grid-column-gap\"],\n\n  // CSS Masking Module Level 1: https://www.w3.org/TR/css-masking/\n  mask: [\n    \"mask-image\",\n    \"mask-mode\",\n    \"mask-position\",\n    \"mask-size\",\n    \"mask-repeat\",\n    \"mask-origin\",\n    \"mask-clip\",\n  ],\n  \"mask-border\": [\n    \"mask-border-source\",\n    \"mask-border-slice\",\n    \"mask-border-width\",\n    \"mask-border-outset\",\n    \"mask-border-repeat\",\n    \"mask-border-mode\",\n  ],\n\n  // CSS Multi-column Layout Module: https://www.w3.org/TR/css3-multicol/\n  columns: [\"column-width\", \"column-count\"],\n  \"column-rule\": [\n    \"column-rule-width\",\n    \"column-rule-style\",\n    \"column-rule-color\",\n  ],\n\n  // CSS Scroll Snap Module Level 1: https://www.w3.org/TR/css-scroll-snap-1/\n  \"scroll-padding\": [\n    \"scroll-padding-top\",\n    \"scroll-padding-right\",\n    \"scroll-padding-bottom\",\n    \"scroll-padding-left\",\n  ],\n  \"scroll-padding-block\": [\n    \"scroll-padding-block-start\",\n    \"scroll-padding-block-end\",\n  ],\n  \"scroll-padding-inline\": [\n    \"scroll-padding-inline-start\",\n    \"scroll-padding-inline-end\",\n  ],\n  \"scroll-snap-margin\": [\n    \"scroll-snap-margin-top\",\n    \"scroll-snap-margin-right\",\n    \"scroll-snap-margin-bottom\",\n    \"scroll-snap-margin-left\",\n  ],\n  \"scroll-snap-margin-block\": [\n    \"scroll-snap-margin-block-start\",\n    \"scroll-snap-margin-block-end\",\n  ],\n  \"scroll-snap-margin-inline\": [\n    \"scroll-snap-margin-inline-start\",\n    \"scroll-snap-margin-inline-end\",\n  ],\n\n  // CSS Speech Module: https://www.w3.org/TR/css3-speech/\n  cue: [\"cue-before\", \"cue-after\"],\n  pause: [\"pause-before\", \"pause-after\"],\n  rest: [\"rest-before\", \"rest-after\"],\n\n  // CSS Text Decoration Module Level 3: https://www.w3.org/TR/css-text-decor-3/\n  \"text-decoration\": [\n    \"text-decoration-line\",\n    \"text-decoration-style\",\n    \"text-decoration-color\",\n  ],\n  \"text-emphasis\": [\"text-emphasis-style\", \"text-emphasis-color\"],\n\n  // CSS Animations (WD): https://www.w3.org/TR/css3-animations\n  animation: [\n    \"animation-name\",\n    \"animation-duration\",\n    \"animation-timing-function\",\n    \"animation-delay\",\n    \"animation-iteration-count\",\n    \"animation-direction\",\n    \"animation-fill-mode\",\n    \"animation-play-state\",\n  ],\n\n  // CSS Transitions (WD): https://www.w3.org/TR/css3-transitions/\n  transition: [\n    \"transition-property\",\n    \"transition-duration\",\n    \"transition-timing-function\",\n    \"transition-delay\",\n  ],\n};\n\nexport function validateNoMixedHand(style: Object) {\n  const hyphenatedProperties = Object.keys(style).reduce((acc, property) => {\n    acc[hyphenate(property)] = property;\n    return acc;\n  }, {});\n\n  const mixed = [];\n  for (const property in hyphenatedProperties) {\n    if (property in shorthandMap) {\n      for (const longhand of shorthandMap[property]) {\n        if (longhand in hyphenatedProperties) {\n          const long = hyphenatedProperties[longhand];\n          const short = hyphenatedProperties[property];\n          mixed.push({\n            shorthand: {property: short, value: style[short]},\n            longhand: {property: long, value: style[long]},\n          });\n        }\n      }\n    }\n  }\n  return mixed;\n}\n","// @flow\n\ndeclare var __DEV__: boolean;\n\nimport hyphenate from \"./hyphenate-style-name.js\";\nimport {validateNoMixedHand} from \"./validate-no-mixed-hand.js\";\nimport {prefix} from \"inline-style-prefixer\";\n\nimport type {StyleObject} from \"styletron-standard\";\n\nimport {MultiCache} from \"./cache.js\";\n\nexport default function injectStylePrefixed(\n  styleCache: MultiCache<{pseudo: string, block: string}>,\n  styles: StyleObject,\n  media: string,\n  pseudo: string,\n) {\n  const cache = styleCache.getCache(media);\n  let classString = \"\";\n  for (const originalKey in styles) {\n    const originalVal = styles[originalKey];\n\n    if (originalVal === void 0 || originalVal === null) {\n      continue;\n    }\n    if (typeof originalVal !== \"object\") {\n      // Non-null and non-undefined primitive value\n      if (__DEV__) {\n        validateValueType(originalVal, originalKey);\n      }\n\n      const propValPair = `${hyphenate(\n        originalKey,\n      )}:${((originalVal: any): string)}`;\n      const key = `${pseudo}${propValPair}`;\n      const cachedId = cache.cache[key];\n      if (cachedId !== void 0) {\n        // cache hit\n        classString += \" \" + cachedId;\n        continue;\n      } else {\n        // cache miss\n        let block = \"\";\n        const prefixed = prefix({[originalKey]: originalVal});\n        for (const prefixedKey in prefixed) {\n          const prefixedVal = prefixed[prefixedKey];\n          const prefixedValType = typeof prefixedVal;\n          if (prefixedValType === \"string\" || prefixedValType === \"number\") {\n            const prefixedPair = `${hyphenate(prefixedKey)}:${prefixedVal}`;\n            if (prefixedPair !== propValPair) {\n              block += `${prefixedPair};`;\n            }\n          } else if (Array.isArray(prefixedVal)) {\n            const hyphenated = hyphenate(prefixedKey);\n            for (let i = 0; i < prefixedVal.length; i++) {\n              const prefixedPair = `${hyphenated}:${prefixedVal[i]}`;\n              if (prefixedPair !== propValPair) {\n                block += `${prefixedPair};`;\n              }\n            }\n          }\n        }\n        block += propValPair; // ensure original prop/val is last (for hydration)\n        const id = cache.addValue(key, {pseudo, block});\n        classString += \" \" + id;\n      }\n    } else {\n      // Non-null object value\n      if (originalKey[0] === \":\") {\n        classString +=\n          \" \" +\n          injectStylePrefixed(\n            styleCache,\n            originalVal,\n            media,\n            pseudo + originalKey,\n          );\n      } else if (originalKey.substring(0, 6) === \"@media\") {\n        classString +=\n          \" \" +\n          injectStylePrefixed(\n            styleCache,\n            originalVal,\n            originalKey.substr(7),\n            pseudo,\n          );\n      }\n    }\n  }\n\n  if (__DEV__) {\n    const conflicts = validateNoMixedHand(styles);\n    if (conflicts.length) {\n      conflicts.forEach(({shorthand, longhand}) => {\n        const short = JSON.stringify({[shorthand.property]: shorthand.value});\n        const long = JSON.stringify({[longhand.property]: longhand.value});\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Styles \\`${short}\\` and \\`${long}\\` in object yielding class \"${classString.slice(\n            1,\n          )}\" may result in unexpected behavior. Mixing shorthand and longhand properties within the same style object is unsupported with atomic rendering.`,\n        );\n      });\n    }\n  }\n\n  // remove leading space\n  return classString.slice(1);\n}\n\nfunction validateValueType(value, key) {\n  if (\n    value === null ||\n    Array.isArray(value) ||\n    (typeof value !== \"number\" && typeof value !== \"string\")\n  ) {\n    throw new Error(\n      `Unsupported style value: ${JSON.stringify(\n        value,\n      )} used in property ${JSON.stringify(key)}`,\n    );\n  }\n}\n","// @flow\n\n/* eslint-disable no-console */\n\nconst validAnimationState = /^(from|to|\\+?(\\d*\\.)?\\d+%)(\\s*,\\s*(from|to|\\+?(\\d*\\.)?\\d+%))*$/;\n\nexport default function validateKeyframesObject(keyframes: Object) {\n  let valid = true;\n  for (const animationState in keyframes) {\n    const value = keyframes[animationState];\n    if (!validAnimationState.test(animationState)) {\n      valid = false;\n      console.warn(\n        `Warning: property \"${animationState}\" in keyframes object ${JSON.stringify(\n          keyframes,\n        )} is not a valid. Must be \"from\", \"to\", or a percentage.`,\n      );\n    }\n    if (typeof value !== \"object\") {\n      valid = false;\n      console.warn(\n        `Warning: value for \"${animationState}\" property in keyframes object ${JSON.stringify(\n          keyframes,\n        )} must be an object. Instead it was a ${typeof value}.`,\n      );\n    }\n    if (!valid) {\n      console.warn(\n        `Warning: object used as value for \"animationName\" style is invalid:`,\n        keyframes,\n      );\n    }\n  }\n}\n","// @flow\n\ndeclare var __DEV__: boolean;\n\nimport hyphenate from \"./hyphenate-style-name.js\";\nimport validateKeyframesObject from \"./validate-keyframes-object.js\";\n\nexport function atomicSelector(id: string, pseudo: string): string {\n  let selector = `.${id}`;\n  if (pseudo) {\n    selector += pseudo;\n  }\n  return selector;\n}\n\nexport function keyframesToBlock(keyframes: {[string]: Object}): string {\n  if (__DEV__) {\n    validateKeyframesObject(keyframes);\n  }\n  if (__DEV__ && typeof Object.getPrototypeOf(keyframes) !== \"undefined\") {\n    if (Object.getPrototypeOf(keyframes) !== Object.getPrototypeOf({})) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        \"Only plain objects should be used as animation values. Unexpectedly recieved:\",\n        keyframes,\n      );\n    }\n  }\n  let result = \"\";\n  for (const animationState in keyframes) {\n    result += `${animationState}{${declarationsToBlock(\n      keyframes[animationState],\n    )}}`;\n  }\n  return result;\n}\n\nexport function declarationsToBlock(style: Object): string {\n  let css = \"\";\n  for (const prop in style) {\n    const val = style[prop];\n    if (typeof val === \"string\" || typeof val === \"number\") {\n      css += `${hyphenate(prop)}:${val};`;\n    }\n  }\n  // trim trailing semicolon\n  return css.slice(0, -1);\n}\n\nexport function keyframesBlockToRule(id: string, block: string): string {\n  return `@keyframes ${id}{${block}}`;\n}\n\nexport function fontFaceBlockToRule(id: string, block: string): string {\n  return `@font-face{font-family:${id};${block}}`;\n}\n\nexport function styleBlockToRule(selector: string, block: string): string {\n  return `${selector}{${block}}`;\n}\n","/* eslint-env browser */\nexport const insertRuleIntoDevtools = (selector, block) => {\n  // start after the . combinator and cut at the first : if there is one to cut out the pseudo classes\n  const key = selector.substring(\n    1,\n    selector.indexOf(\":\") !== -1 ? selector.indexOf(\":\") : selector.length,\n  );\n  const styles = {};\n  // split the declaration to catch vendor prefixing\n  for (const decl of block.split(\";\")) {\n    if (decl.trim() !== \"\" && !window.__STYLETRON_DEVTOOLS__.atomicMap[key])\n      styles[decl.substring(0, decl.indexOf(\":\"))] = decl.substring(\n        decl.indexOf(\":\") + 1,\n        decl.length,\n      );\n  }\n\n  window.__STYLETRON_DEVTOOLS__.atomicMap[key] = styles;\n};\n\nexport const hydrateDevtoolsRule = cssString => {\n  const id = cssString.substring(0, 3);\n  const block = cssString.substring(4, cssString.length - 1);\n  insertRuleIntoDevtools(id, block);\n};\n","// @flow\n\n/* eslint-env browser */\n\ndeclare var __DEV__: boolean;\ndeclare var __BROWSER__: boolean;\n\nconst STYLES_HYDRATOR = /\\.([^{:]+)(:[^{]+)?{(?:[^}]*;)?([^}]*?)}/g;\nconst KEYFRAMES_HYRDATOR = /@keyframes ([^{]+)\\{((?:[^{]+\\{[^}]*\\})*)\\}/g;\nconst FONT_FACE_HYDRATOR = /@font-face\\{font-family:([^;]+);([^}]*)\\}/g;\n\ntype hydratorT =\n  | typeof STYLES_HYDRATOR\n  | typeof KEYFRAMES_HYRDATOR\n  | typeof FONT_FACE_HYDRATOR;\n\nfunction hydrateStyles<T>(cache: Cache<T>, hydrator: hydratorT, css: string) {\n  let match;\n  while ((match = hydrator.exec(css))) {\n    const [, id, pseudo, key] = match;\n    if (__BROWSER__ && __DEV__ && window.__STYLETRON_DEVTOOLS__) {\n      hydrateDevtoolsRule(match[0]);\n    }\n    const fullKey = pseudo ? `${pseudo}${key}` : key;\n    cache.cache[fullKey] = id; // set cache without triggering side effects\n    cache.idGenerator.increment(); // increment id\n  }\n}\n\nfunction hydrate<T>(cache: Cache<T>, hydrator: hydratorT, css: string) {\n  let match;\n  while ((match = hydrator.exec(css))) {\n    const [, id, key] = match;\n    if (__BROWSER__ && __DEV__ && window.__STYLETRON_DEVTOOLS__) {\n      hydrateDevtoolsRule(match[0]);\n    }\n    cache.cache[key] = id; // set cache without triggering side effects\n    cache.idGenerator.increment(); // increment id\n  }\n}\n\nimport SequentialIDGenerator from \"../sequential-id-generator.js\";\n\nimport type {\n  StandardEngine,\n  KeyframesObject,\n  FontFaceObject,\n  StyleObject,\n} from \"styletron-standard\";\n\nimport {Cache, MultiCache} from \"../cache.js\";\n\nimport injectStylePrefixed from \"../inject-style-prefixed.js\";\n\nimport {\n  styleBlockToRule,\n  atomicSelector,\n  keyframesBlockToRule,\n  declarationsToBlock,\n  keyframesToBlock,\n  fontFaceBlockToRule,\n} from \"../css.js\";\nimport {insertRuleIntoDevtools, hydrateDevtoolsRule} from \"../dev-tool.js\";\n\ntype hydrateT =\n  | HTMLCollection<HTMLStyleElement>\n  | Array<HTMLStyleElement>\n  | NodeList<HTMLStyleElement>;\n\ntype optionsT = {\n  hydrate?: hydrateT,\n  container?: Element,\n  prefix?: string,\n};\n\nclass StyletronClient implements StandardEngine {\n  container: Element;\n  styleElements: {[string]: HTMLStyleElement};\n  fontFaceSheet: HTMLStyleElement;\n  keyframesSheet: HTMLStyleElement;\n\n  styleCache: MultiCache<{pseudo: string, block: string}>;\n  keyframesCache: Cache<KeyframesObject>;\n  fontFaceCache: Cache<FontFaceObject>;\n\n  constructor(opts?: optionsT = {}) {\n    this.styleElements = {};\n\n    const styleIdGenerator = new SequentialIDGenerator(opts.prefix);\n    const onNewStyle = (cache, id, value) => {\n      const {pseudo, block} = value;\n      const sheet: CSSStyleSheet = (this.styleElements[cache.key].sheet: any);\n      const selector = atomicSelector(id, pseudo);\n      const rule = styleBlockToRule(selector, block);\n      try {\n        sheet.insertRule(rule, sheet.cssRules.length);\n        if (__BROWSER__ && __DEV__ && window.__STYLETRON_DEVTOOLS__) {\n          insertRuleIntoDevtools(selector, block);\n        }\n      } catch (e) {\n        if (__DEV__) {\n          // eslint-disable-next-line no-console\n          console.warn(\n            `Failed to inject CSS: \"${rule}\". Perhaps this has invalid or un-prefixed properties?`,\n          );\n        }\n      }\n    };\n\n    // Setup style cache\n    this.styleCache = new MultiCache(\n      styleIdGenerator,\n      (media, _cache, insertBeforeMedia) => {\n        const styleElement = document.createElement(\"style\");\n        styleElement.media = media;\n        if (insertBeforeMedia === void 0) {\n          this.container.appendChild(styleElement);\n        } else {\n          const insertBeforeIndex = findSheetIndexWithMedia(\n            this.container.children,\n            insertBeforeMedia,\n          );\n          this.container.insertBefore(\n            styleElement,\n            this.container.children[insertBeforeIndex],\n          );\n        }\n\n        this.styleElements[media] = styleElement;\n      },\n      onNewStyle,\n    );\n\n    this.keyframesCache = new Cache(\n      new SequentialIDGenerator(opts.prefix),\n      (cache, id, value) => {\n        this.styleCache.getCache(\"\");\n        const sheet: CSSStyleSheet = (this.styleElements[\"\"].sheet: any);\n        const rule = keyframesBlockToRule(id, keyframesToBlock(value));\n        try {\n          sheet.insertRule(rule, sheet.cssRules.length);\n        } catch (e) {\n          if (__DEV__) {\n            // eslint-disable-next-line no-console\n            console.warn(\n              `Failed to inject CSS: \"${rule}\". Perhaps this has invalid or un-prefixed properties?`,\n            );\n          }\n        }\n      },\n    );\n\n    this.fontFaceCache = new Cache(\n      new SequentialIDGenerator(opts.prefix),\n      (cache, id, value) => {\n        this.styleCache.getCache(\"\");\n        const sheet: CSSStyleSheet = (this.styleElements[\"\"].sheet: any);\n        const rule = fontFaceBlockToRule(id, declarationsToBlock(value));\n        try {\n          sheet.insertRule(rule, sheet.cssRules.length);\n        } catch (e) {\n          if (__DEV__) {\n            // eslint-disable-next-line no-console\n            console.warn(\n              `Failed to inject CSS: \"${rule}\". Perhaps this has invalid or un-prefixed properties?`,\n            );\n          }\n        }\n      },\n    );\n\n    if (opts.container) {\n      this.container = opts.container;\n    }\n\n    // Hydrate\n    if (opts.hydrate && opts.hydrate.length > 0) {\n      // infer container from parent element\n      if (!this.container) {\n        const parentElement = opts.hydrate[0].parentElement;\n        if (parentElement !== null && parentElement !== void 0) {\n          this.container = parentElement;\n        }\n      }\n\n      for (let i = 0; i < opts.hydrate.length; i++) {\n        const element = opts.hydrate[i];\n        const hydrateType = element.getAttribute(\"data-hydrate\");\n        if (hydrateType === \"font-face\") {\n          hydrate(this.fontFaceCache, FONT_FACE_HYDRATOR, element.textContent);\n          continue;\n        }\n        if (hydrateType === \"keyframes\") {\n          hydrate(this.keyframesCache, KEYFRAMES_HYRDATOR, element.textContent);\n          continue;\n        }\n        const key = element.media ? element.media : \"\";\n        this.styleElements[key] = element;\n        const cache = new Cache(styleIdGenerator, onNewStyle);\n        cache.key = key;\n        hydrateStyles(cache, STYLES_HYDRATOR, element.textContent);\n        this.styleCache.sortedCacheKeys.push(key);\n        this.styleCache.caches[key] = cache;\n      }\n    }\n\n    if (!this.container) {\n      if (document.head === null) {\n        throw new Error(\"No container provided and `document.head` was null\");\n      }\n      this.container = document.head;\n    }\n  }\n\n  renderStyle(style: StyleObject): string {\n    return injectStylePrefixed(this.styleCache, style, \"\", \"\");\n  }\n\n  renderFontFace(fontFace: FontFaceObject): string {\n    const key = declarationsToBlock(fontFace);\n    return this.fontFaceCache.addValue(key, fontFace);\n  }\n\n  renderKeyframes(keyframes: KeyframesObject): string {\n    const key = keyframesToBlock(keyframes);\n    return this.keyframesCache.addValue(key, keyframes);\n  }\n}\n\nexport default StyletronClient;\n\nfunction findSheetIndexWithMedia(children, media) {\n  let index = 0;\n  for (; index < children.length; index++) {\n    const child = children[index];\n    if (\n      child.tagName === \"STYLE\" &&\n      ((child: any): HTMLStyleElement).media === media\n    ) {\n      return index;\n    }\n  }\n\n  return -1;\n}\n","// @flow\n\nimport SequentialIDGenerator from \"../sequential-id-generator.js\";\n\nimport type {StandardEngine} from \"styletron-standard\";\n\nimport {Cache, MultiCache} from \"../cache.js\";\n\nimport injectStylePrefixed from \"../inject-style-prefixed.js\";\n\nimport type {\n  StyleObject,\n  FontFaceObject,\n  KeyframesObject,\n} from \"styletron-standard\";\n\nimport {\n  styleBlockToRule,\n  atomicSelector,\n  keyframesBlockToRule,\n  declarationsToBlock,\n  keyframesToBlock,\n  fontFaceBlockToRule,\n} from \"../css.js\";\n\nexport type attrsT = {\n  \"data-hydrate\"?: \"keyframes\" | \"font-face\",\n  media?: string,\n  class?: string,\n};\n\nexport type sheetT = {|\n  css: string,\n  attrs: attrsT,\n|};\n\ntype optionsT = {\n  prefix?: string,\n};\n\nclass StyletronServer implements StandardEngine {\n  styleCache: MultiCache<{pseudo: string, block: string}>;\n  keyframesCache: Cache<KeyframesObject>;\n  fontFaceCache: Cache<FontFaceObject>;\n  styleRules: {[string]: string};\n  keyframesRules: string;\n  fontFaceRules: string;\n\n  constructor(opts?: optionsT = {}) {\n    this.styleRules = {\"\": \"\"};\n    this.styleCache = new MultiCache(\n      new SequentialIDGenerator(opts.prefix),\n      media => {\n        this.styleRules[media] = \"\";\n      },\n      (cache, id, value) => {\n        const {pseudo, block} = value;\n        this.styleRules[cache.key] += styleBlockToRule(\n          atomicSelector(id, pseudo),\n          block,\n        );\n      },\n    );\n\n    this.fontFaceRules = \"\";\n    this.fontFaceCache = new Cache(\n      new SequentialIDGenerator(opts.prefix),\n      (cache, id, value) => {\n        this.fontFaceRules += fontFaceBlockToRule(\n          id,\n          declarationsToBlock(value),\n        );\n      },\n    );\n\n    this.keyframesRules = \"\";\n    this.keyframesCache = new Cache(\n      new SequentialIDGenerator(opts.prefix),\n      (cache, id, value) => {\n        this.keyframesRules += keyframesBlockToRule(\n          id,\n          keyframesToBlock(value),\n        );\n      },\n    );\n  }\n\n  renderStyle(style: StyleObject): string {\n    return injectStylePrefixed(this.styleCache, style, \"\", \"\");\n  }\n\n  renderFontFace(fontFace: FontFaceObject): string {\n    const key = JSON.stringify(fontFace);\n    return this.fontFaceCache.addValue(key, fontFace);\n  }\n\n  renderKeyframes(keyframes: KeyframesObject): string {\n    const key = JSON.stringify(keyframes);\n    return this.keyframesCache.addValue(key, keyframes);\n  }\n\n  getStylesheets(): Array<sheetT> {\n    return [\n      ...(this.keyframesRules.length\n        ? [\n            {\n              css: this.keyframesRules,\n              attrs: {\"data-hydrate\": \"keyframes\"},\n            },\n          ]\n        : []),\n      ...(this.fontFaceRules.length\n        ? [\n            {\n              css: this.fontFaceRules,\n              attrs: {\"data-hydrate\": \"font-face\"},\n            },\n          ]\n        : []),\n      ...sheetify(this.styleRules, this.styleCache.getSortedCacheKeys()),\n    ];\n  }\n\n  getStylesheetsHtml(className?: string = \"_styletron_hydrate_\") {\n    return generateHtmlString(this.getStylesheets(), className);\n  }\n\n  getCss() {\n    return (\n      this.keyframesRules +\n      this.fontFaceRules +\n      stringify(this.styleRules, this.styleCache.getSortedCacheKeys())\n    );\n  }\n}\n\nexport function generateHtmlString(sheets: Array<sheetT>, className: string) {\n  let html = \"\";\n  for (let i = 0; i < sheets.length; i++) {\n    const sheet = sheets[i];\n    const {class: originalClassName, ...rest} = sheet.attrs;\n    const attrs = {\n      class: originalClassName\n        ? `${className} ${originalClassName}`\n        : className,\n      ...(rest: attrsT),\n    };\n    html += `<style${attrsToString(attrs)}>${sheet.css}</style>`;\n  }\n  return html;\n}\n\nfunction attrsToString(attrs: attrsT) {\n  let result = \"\";\n  for (const attr in attrs) {\n    const value = attrs[attr];\n    if (value === true) {\n      result += \" \" + attr;\n    } else if (value !== false) {\n      result += ` ${attr}=\"${value}\"`;\n    }\n  }\n  return result;\n}\n\nfunction stringify(styleRules, sortedCacheKeys) {\n  let result = \"\";\n  sortedCacheKeys.forEach(cacheKey => {\n    const rules = styleRules[cacheKey];\n    if (cacheKey !== \"\") {\n      result += `@media ${cacheKey}{${rules}}`;\n    } else {\n      result += rules;\n    }\n  });\n  return result;\n}\n\nfunction sheetify(styleRules, sortedCacheKeys): Array<sheetT> {\n  if (sortedCacheKeys.length === 0) {\n    return [{css: \"\", attrs: {}}];\n  }\n  const sheets = [];\n  sortedCacheKeys.forEach(cacheKey => {\n    // omit media (cacheKey) attribute if empty\n    const attrs = cacheKey === \"\" ? {} : {media: cacheKey};\n    sheets.push({css: styleRules[cacheKey], attrs});\n  });\n  return sheets;\n}\n\nexport default StyletronServer;\n"],"names":["SequentialIDGenerator","prefix","count","offset","msb","power","next","id","increment","toString","Math","pow","minMaxWidth","minWidth","maxMinWidth","maxWidth","isMinWidth","_testQuery","isMaxWidth","minMaxHeight","minHeight","maxMinHeight","maxHeight","isMinHeight","isMaxHeight","isPrint","isPrintOnly","maxValue","Number","MAX_VALUE","_getQueryLength","length","matches","exec","number","unit","parseFloat","doubleTestTrue","doubleTestFalse","singleTest","query","test","_testIsPrint","a","b","isPrintA","isPrintOnlyA","isPrintB","isPrintOnlyB","localeCompare","sortCSSmq","testIsPrint","minA","maxA","minB","maxB","lengthA","lengthB","MultiCache","idGenerator","onNewCache","onNewValue","sortedCacheKeys","caches","getCache","key","cache","Cache","push","sort","sortMq","keyIndex","indexOf","insertBeforeMedia","getSortedCacheKeys","addValue","value","cached","uppercasePattern","msPattern","hyphenateStyleName","prop","replace","toLowerCase","shorthandMap","validateNoMixedHand","style","hyphenatedProperties","Object","keys","reduce","acc","property","hyphenate","mixed","longhand","long","short","injectStylePrefixed","styleCache","styles","media","pseudo","classString","originalKey","originalVal","propValPair","cachedId","block","prefixed","prefixedKey","prefixedVal","prefixedValType","prefixedPair","Array","isArray","hyphenated","i","substring","substr","conflicts","forEach","shorthand","JSON","stringify","warn","slice","validateValueType","Error","validAnimationState","validateKeyframesObject","keyframes","valid","animationState","_typeof","atomicSelector","selector","keyframesToBlock","getPrototypeOf","result","declarationsToBlock","css","val","keyframesBlockToRule","fontFaceBlockToRule","styleBlockToRule","insertRuleIntoDevtools","split","decl","trim","window","__STYLETRON_DEVTOOLS__","atomicMap","hydrateDevtoolsRule","cssString","STYLES_HYDRATOR","KEYFRAMES_HYRDATOR","FONT_FACE_HYDRATOR","hydrateStyles","hydrator","match","fullKey","hydrate","StyletronClient","opts","styleElements","styleIdGenerator","onNewStyle","sheet","rule","insertRule","cssRules","e","_cache","styleElement","document","createElement","container","appendChild","insertBeforeIndex","findSheetIndexWithMedia","children","insertBefore","keyframesCache","fontFaceCache","parentElement","element","hydrateType","getAttribute","textContent","head","renderStyle","renderFontFace","fontFace","renderKeyframes","index","child","tagName","StyletronServer","styleRules","fontFaceRules","keyframesRules","getStylesheets","sheetify","getStylesheetsHtml","className","generateHtmlString","getCss","sheets","html","attrs","originalClassName","class","rest","attrsToString","attr","rules","cacheKey"],"mappings":"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"}